// API route to notify campaign about approaching view limit
app.post('/campaign/:id/check-limit', async (req, res) => {
    try {
        const campaign = await Campaign.findById(req.params.id);
        if (!campaign) return res.status(404).send('Campaign not found');

        const remainingViews = campaign.viewLimit - campaign.viewCount;
        
        // Send warning if view count exceeds 90% of the limit
        if (remainingViews <= (campaign.viewLimit * 0.1)) {
            res.status(200).send({ message: `Warning: Only ${remainingViews} views remaining. Please upgrade your plan.` });
        } else {
            res.status(200).send({ message: `${remainingViews} views remaining.` });
        }
    } catch (error) {
        res.status(500).send(error.message);
    }
});
